<navbar title="添加收支"></navbar>
<view class="page">
  <view class="card form-card">
    <view class="form-item">
      <text class="label">类型*</text>
      <picker mode="selector" range="{{typeOptions}}" range-key="label" value="{{typeIndex}}" bindchange="handleTypeChange">
        <view class="picker-value">{{typeLabel}}</view>
      </picker>
    </view>
    <view class="form-item">
      <text class="label">类别*</text>
      <picker mode="selector" range="{{categoryOptions}}" range-key="label" value="{{categoryIndex}}" bindchange="handleCategoryChange">
        <view class="picker-value">{{categoryDisplay}}</view>
      </picker>
    </view>
    <view class="form-item">
      <text class="label">金额*</text>
      <input type="number" placeholder="请输入金额" data-key="amount" value="{{form.amount}}" bindinput="handleInput" />
    </view>
    <view class="form-item">
      <text class="label">日期*</text>
      <picker mode="date" value="{{form.date}}" bindchange="handleDateChange">
        <view class="picker-value">{{form.date}}</view>
      </picker>
    </view>
    <view class="form-item row">
      <text class="label">预计项</text>
      <switch checked="{{form.planned}}" bindchange="handlePlannedChange"></switch>
    </view>
    <view class="form-item row">
      <text class="label">每月重复</text>
      <switch checked="{{form.recurring_monthly}}" bindchange="handleRecurringChange"></switch>
    </view>
    <view class="form-item" wx:if="{{form.recurring_monthly}}">
      <text class="label">开始日期*</text>
      <picker mode="date" value="{{form.recurring_start_date}}" bindchange="handleRecurringStartChange">
        <view class="picker-value">{{form.recurring_start_date || '请选择开始日期'}}</view>
      </picker>
    </view>
    <view class="form-item" wx:if="{{form.recurring_monthly}}">
      <text class="label">结束日期</text>
      <picker mode="date" value="{{form.recurring_end_date}}" bindchange="handleRecurringEndChange">
        <view class="picker-value">{{form.recurring_end_date || '请选择结束日期'}}</view>
      </picker>
    </view>
    <view class="form-item" wx:if="{{form.type === 'income' && form.category === '租金收入'}}">
      <text class="label">资产名称*</text>
      <input placeholder="请输入资产名称" value="{{hidden.account_name}}" data-key="account_name" bindinput="handleHiddenInput" />
    </view>
    <view class="form-item" wx:if="{{form.type === 'income' && form.category === '租金收入'}}">
      <text class="label">租客姓名*</text>
      <input placeholder="请输入租客姓名" value="{{hidden.tenant_name}}" data-key="tenant_name" bindinput="handleHiddenInput" />
    </view>
    <view class="form-item">
      <text class="label">备注</text>
      <textarea placeholder="可选" data-key="note" value="{{form.note}}" bindinput="handleInput" />
    </view>
    <button bindtap="submit" loading="{{submitting}}" style="background-color: #43B176; color: #ffffff;">保存</button>
  </view>
</view>
